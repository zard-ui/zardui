{
  "name": "date-picker",
  "type": "registry:component",
  "files": [
    {
      "name": "date-picker.component.ts",
      "content": "import { DatePipe } from '@angular/common';\nimport {\n  ChangeDetectionStrategy,\n  Component,\n  computed,\n  forwardRef,\n  inject,\n  input,\n  model,\n  output,\n  viewChild,\n  ViewEncapsulation,\n  type TemplateRef,\n} from '@angular/core';\nimport { NG_VALUE_ACCESSOR, type ControlValueAccessor } from '@angular/forms';\n\nimport type { ClassValue } from 'clsx';\n\nimport { datePickerVariants, type ZardDatePickerVariants } from './date-picker.variants';\nimport { ZardButtonComponent } from '../button/button.component';\nimport { ZardCalendarComponent } from '../calendar/calendar.component';\nimport { ZardIconComponent } from '../icon/icon.component';\nimport { ZardPopoverComponent, ZardPopoverDirective } from '../popover/popover.component';\n\nimport { mergeClasses } from '@/shared/utils/merge-classes';\n\nconst HEIGHT_BY_SIZE: Record<NonNullable<ZardDatePickerVariants['zSize']>, string> = {\n  sm: 'h-8',\n  default: 'h-10',\n  lg: 'h-12',\n};\n\n@Component({\n  selector: 'z-date-picker, [z-date-picker]',\n  imports: [ZardButtonComponent, ZardCalendarComponent, ZardPopoverComponent, ZardPopoverDirective, ZardIconComponent],\n  standalone: true,\n  template: `\n    <button\n      z-button\n      type=\"button\"\n      [zType]=\"zType()\"\n      [zSize]=\"zSize()\"\n      [disabled]=\"disabled()\"\n      [class]=\"buttonClasses()\"\n      zPopover\n      #popoverDirective=\"zPopover\"\n      [zContent]=\"calendarTemplate\"\n      zTrigger=\"click\"\n      (zVisibleChange)=\"onPopoverVisibilityChange($event)\"\n      [attr.aria-expanded]=\"false\"\n      [attr.aria-haspopup]=\"true\"\n      aria-label=\"Choose date\"\n    >\n      <z-icon zType=\"calendar\" />\n      <span [class]=\"textClasses()\">\n        {{ displayText() }}\n      </span>\n    </button>\n\n    <ng-template #calendarTemplate>\n      <z-popover [class]=\"popoverClasses()\">\n        <z-calendar\n          #calendar\n          class=\"border-0\"\n          [value]=\"value()\"\n          [minDate]=\"minDate()\"\n          [maxDate]=\"maxDate()\"\n          [disabled]=\"disabled()\"\n          (dateChange)=\"onDateChange($event)\"\n        />\n      </z-popover>\n    </ng-template>\n  `,\n  providers: [\n    DatePipe,\n    {\n      provide: NG_VALUE_ACCESSOR,\n      useExisting: forwardRef(() => ZardDatePickerComponent),\n      multi: true,\n    },\n  ],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n  host: {},\n  exportAs: 'zDatePicker',\n})\nexport class ZardDatePickerComponent implements ControlValueAccessor {\n  private readonly datePipe = inject(DatePipe);\n\n  readonly calendarTemplate = viewChild.required<TemplateRef<unknown>>('calendarTemplate');\n  readonly popoverDirective = viewChild.required<ZardPopoverDirective>('popoverDirective');\n  readonly calendar = viewChild.required<ZardCalendarComponent>('calendar');\n\n  readonly class = input<ClassValue>('');\n  readonly zType = input<ZardDatePickerVariants['zType']>('outline');\n  readonly zSize = input<ZardDatePickerVariants['zSize']>('default');\n  readonly value = model<Date | null>(null);\n  readonly placeholder = input<string>('Pick a date');\n  readonly zFormat = input<string>('MMMM d, yyyy');\n  readonly minDate = input<Date | null>(null);\n  readonly maxDate = input<Date | null>(null);\n  readonly disabled = model<boolean>(false);\n\n  readonly dateChange = output<Date | null>();\n\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  private onChange: (value: Date | null) => void = () => {};\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  private onTouched: () => void = () => {};\n\n  protected readonly classes = computed(() =>\n    mergeClasses(\n      datePickerVariants({\n        zSize: this.zSize(),\n      }),\n      this.class(),\n    ),\n  );\n\n  protected readonly buttonClasses = computed(() => {\n    const hasValue = !!this.value();\n    const size: NonNullable<ZardDatePickerVariants['zSize']> = this.zSize() ?? 'default';\n    const height = HEIGHT_BY_SIZE[size];\n    return mergeClasses(\n      'justify-start text-left font-normal',\n      !hasValue && 'text-muted-foreground',\n      height,\n      'min-w-[240px]',\n    );\n  });\n\n  protected readonly textClasses = computed(() => {\n    const hasValue = !!this.value();\n    return mergeClasses(!hasValue && 'text-muted-foreground');\n  });\n\n  protected readonly popoverClasses = computed(() => mergeClasses('w-auto p-0'));\n\n  protected readonly displayText = computed(() => {\n    const date = this.value();\n    if (!date) {\n      return this.placeholder();\n    }\n    return this.formatDate(date, this.zFormat());\n  });\n\n  protected onDateChange(date: Date | Date[]): void {\n    // Date picker always uses single mode, so we can safely cast\n    const singleDate = Array.isArray(date) ? (date[0] ?? null) : date;\n    this.value.set(singleDate);\n    this.onChange(singleDate);\n    this.onTouched();\n    this.dateChange.emit(singleDate);\n\n    this.popoverDirective().hide();\n  }\n\n  protected onPopoverVisibilityChange(visible: boolean): void {\n    if (visible) {\n      setTimeout(() => {\n        if (this.calendar()) {\n          this.calendar().resetNavigation();\n        }\n      });\n    }\n  }\n\n  private formatDate(date: Date, format: string): string {\n    return this.datePipe.transform(date, format) ?? '';\n  }\n\n  writeValue(value: Date | null): void {\n    this.value.set(value);\n  }\n\n  registerOnChange(fn: (value: Date | null) => void): void {\n    this.onChange = fn;\n  }\n\n  registerOnTouched(fn: () => void): void {\n    this.onTouched = fn;\n  }\n\n  setDisabledState(isDisabled: boolean): void {\n    this.disabled.set(isDisabled);\n  }\n}\n"
    },
    {
      "name": "date-picker.variants.ts",
      "content": "import { cva, type VariantProps } from 'class-variance-authority';\n\nconst datePickerVariants = cva('', {\n  variants: {\n    zSize: {\n      sm: '',\n      default: '',\n      lg: '',\n    },\n    zType: {\n      default: '',\n      outline: '',\n      ghost: '',\n    },\n  },\n  defaultVariants: {\n    zSize: 'default',\n    zType: 'outline',\n  },\n});\n\nexport { datePickerVariants };\nexport type ZardDatePickerVariants = VariantProps<typeof datePickerVariants>;\n"
    }
  ],
  "registryDependencies": [
    "button",
    "calendar",
    "core",
    "popover",
    "input",
    "icon"
  ]
}
